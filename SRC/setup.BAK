*====================================================
* setup.prg
* Бобков И.Н.
* 2005(с)
*====================================================
_screen.WindowState = 2
_screen.Caption    = "КСК v1.1"

SET PROCEDURE TO "procedures"
SET EXCLUSIVE ON
SET SAFETY OFF
SET TALK OFF
SET DELETED ON
SET DATE GERMAN && наша дата
SET ANSI ON 	&& чтоб значения команды SQL - SELECT не урезались
SET ESCAPE OFF

SET COLLATE TO 'RUSSIAN' && режим сортировки символьных строк - Русский
SET EXACT ON

#DEFINE _COMPANYNAME	" "
#DEFINE _COMPANYADRESS	" "
#DEFINE _COMPANYRNN		" "
#DEFINE _COMPANYBANK	" "
#DEFINE _COMPANYSCHET	0

#DEFINE _MONEY   		"тенге"
#DEFINE _DATA    		"DATA\"

PUBLIC UserName  		as Character
PUBLIC BaseName  		as Number
PUBLIC TableName 		as Character
PUBLIC CompanyName 		as Character 
PUBLIC CompanyAdress 	as Character 
PUBLIC CompanyRnn 		as Character 
PUBLIC CompanyBank 		as Character 
PUBLIC CompanySchet 	as Number
PUBLIC Money	 		as Character
PUBLIC Stavka1 			as Number
PUBLIC Stavka2 			as Number
PUBLIC Stavka3 			as Number
PUBLIC Out 				as Number
PUBLIC DataDir 			as Character
PUBLIC MainForm  		as Form
PUBLIC CompID 			as Character
PUBLIC m(12) 			as Character

PUBLIC curpos as Number

*=========[ Пароли ]===========
PUBLIC Acess as Boolean
PUBLIC Pswrd as Character
*==============================
m(1)  = "Январь"
m(2)  = "Февраль"
m(3)  = "Март"
m(4)  = "Апрель"
m(5)  = "Май"
m(6)  = "Июнь"
m(7)  = "Июль"
m(8)  = "Август"
m(9)  = "Сентябрь"
m(10) = "Октябрь"
m(11) = "Ноябрь"
m(12) = "Декабрь"

*=========================
*
*=========================
CompID = " "
IF !FILE(_DATA+"system.mem")
UserName  		= "Admin"
BaseName  		= YEAR(DATE())
TableName 		= m(6)
CompanyName 	= _COMPANYNAME
CompanyAdress 	= _COMPANYADRESS
CompanyRnn	 	= _COMPANYRNN
CompanyBank	 	= _COMPANYBANK
CompanySchet	= _COMPANYSCHET
Money	  		= _MONEY
Stavka1			=  0.00
Stavka2			=  0.00
Stavka3			=  0.00
DataDir			= _DATA
SAVE TO _DATA+"system.mem"
ENDIF

RESTORE FROM (_DATA+"system.mem") ADDITIVE
*===========[ splash ]===========
DO FORM "titlescreen"
WAIT '' TIMEOUT 3
titlescreen.Release()

IF (ID() != CompID)
MESSAGEBOX("Зарегистрируйтесь!", 16, "Программа остановлена")
QUIT
ENDIF
*=========================
*
*=========================
IF (!FILE(DataDir+ALLTRIM(STR(BaseName))+"\"+TableName+".dbf"))
MESSAGEBOX("База за "+TableName+" не обнаружена!!!", 16, _screen.Caption)
QUIT
ENDIF

_screen.Visible = .T.
_screen.Icon = 'SMAL_IKONKA.ICO'
USE DataDir+ALLTRIM(STR(BaseName))+"\"+TableName+".dbf"
WAIT "Загрузка..." NOWAIT WINDOW
PACK		 && Удаление помеченных для удаления записей
DO TableSort && Сортировка перед началом работы
WAIT CLEAR

ON SHUTDOWN DO "endwork"

DO "Main.mpr"
DO FORM "main"
MainForm = _Screen.ActiveForm
READ EVENTS && начало главного цикла


